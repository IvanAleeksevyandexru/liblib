<div [ngClass]="
     {'main-page-view': viewType === 'main-page-view', 'side-view': viewType === 'side-view'}"
     class="catalog-tab-item-wrap">
  <div class="container container-catalog-wrap">
    <div *ngIf="loaded else loading" class="catalog-tab-item">
      <a href class="close-catalog" (click)="closeCatalog($event)"></a>
      <div class="grid-row">
        <div class="col-lg-6 col-3 col-md-6">
          <section>
            <div class="back-title text-plain bold"
                 *ngIf="viewType === 'side-view'"
                 (click)="closeSubCatalog()">{{backTitle}}</div>
            <h3 class="title-h6 catalog-item-title hide show-lg">Популярные услуги</h3>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                  <h4 *ngFor="let item of popular | slice:0:(popularMore ? popularMore : undefined)"
                      (click)="goToPopular(item)"
                      class="title-h6 summer-nigh mt-lg-20 mt-sm-32 mt-md-32 catalog-title-popular">
                        {{item.catalogTitle}}
                  </h4>
                  <ng-container *ngIf="popular && popular.length > popularMore">
                    <div *ngIf="viewType === 'side-view'" class="mt-24 text-plain blue" (click)="popularMore = undefined">
                      Показать все
                    </div>
                  </ng-container>
                  <section *ngIf="viewType === 'main-page-view' && regionName && regionPopular?.length">
                    <ng-template [ngTemplateOutlet]="regionPopularTmpl"></ng-template>
                  </section>
              </perfect-scrollbar>
            </div>
          </section>
        </div>
        <div  class="col-lg-6 col-3 col-md-6">
          <section *ngIf="viewType !== 'main-page-view' && regionName && regionPopular?.length">
            <h5 class="title-h6 catalog-item-title mt-40 catalog-item-title-small">
              Услуги для <span (click)="showRegionModal()" class="catalog-item-title-link">{{regionName}}</span>
            </h5>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                <ng-template [ngTemplateOutlet]="regionPopularTmpl"></ng-template>
              </perfect-scrollbar>
            </div>
          </section>
          <section *ngIf="viewType === 'main-page-view' && faqs?.length">
            <h3 class="title-h6 catalog-item-title">Часто задаваемые вопросы</h3>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                <div *ngFor="let item of faqs | slice:0:(faqsMore ? undefined : itemsCounter)"
                     #elements
                     class="title-h6 summer-nigh mt-lg-24  catalog-title-popular">
                  <div class="flex-container">
                    <div [class.active]="item.active" (click)="toggleFaqsQuestions(item)" class="arrow"></div>
                    <div>
                      <div>
                        <h6 (click)="toggleFaqsQuestions(item)" class="title-h6 summer-nigh mt-lg-20 catalog-title-popular">
                            {{item.shortQuestion || item.question}}
                        </h6>
                        <div [class.active]="item.active" class="faq-answer" [innerHTML]="item.shortAnswer"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <ng-container *ngIf="faqs && faqs.length > itemsCounter && !faqsMore">
                  <div class="mt-24 text-plain blue" (click)="faqsMore = !faqsMore">
                    Показать все
                  </div>
                </ng-container>
              </perfect-scrollbar>
            </div>
          </section>
        </div>
      </div>
      <ng-template #regionPopularTmpl>
        <h5 *ngIf="viewType === 'main-page-view'" class="title-h6 catalog-item-title mt-40 catalog-item-title-small">
          Услуги для <span (click)="showRegionModal()" class="catalog-item-title-link">{{regionName}}</span>
        </h5>
        <h6 (click)="goToPopular(item)"
            *ngFor="let item of regionPopular | slice:0:(regionPopularMore ? undefined : itemsCounter)"
            class="title-h6 summer-nigh mt-lg-20 mt-sm-32 mt-md-32 catalog-title-popular">
          {{item.catalogTitle}}
        </h6>
        <ng-container *ngIf="regionPopular && regionPopular.length > itemsCounter && !regionPopularMore">
          <div class="mt-28 text-plain blue" (click)="regionPopularMore = !regionPopularMore">
            Показать все
          </div>
        </ng-container>
      </ng-template>
    </div>
    <ng-template #loading>
      <div class="catalog-throbber">
        <lib-throbber-hexagon size="big"></lib-throbber-hexagon>
      </div>
    </ng-template>
  </div>
</div>
