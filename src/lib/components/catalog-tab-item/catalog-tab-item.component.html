<div [ngClass]="
     {'main-page-view': viewType === 'main-page-view', 'side-view': viewType === 'side-view'}"
     class="catalog-tab-item-wrap">
  <div class="container container-catalog-wrap">
    <div *ngIf="loaded else loading" class="catalog-tab-item">
      <a href class="close-catalog" (click)="closeCatalog($event)"></a>
      <div class="grid-row">
        <div class="col-lg-6 col-3 col-md-6">
          <section>
            <div class="back-title text-plain bold" *ngIf="viewType === 'side-view'"
                 (click)="closeSubCatalog()">{{backTitle}}</div>
            <h3 *ngIf="code !== 'other'"
                class="title-h6 catalog-item-title hide show-lg">
                  Популярные услуги
            </h3>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                <ng-container *ngIf="code !== 'other' && popular && popular.length">
                  <section class="catalog-title-popular-wrap" *ngFor="let item of popular | slice:0:(popularMore ? popularMore : undefined)">
                    <h4 (click)="goToPopular(item)" class="title-h6 mt-lg-20 mt-sm-32 mt-md-32 catalog-title-popular pointer">
                      {{item.catalogTitle}}
                    </h4>
                  </section>
                  <ng-container *ngIf="popular.length > popularMore">
                    <div *ngIf="viewType === 'side-view'" class="mt-24 text-plain blue" (click)="popularMore = undefined">
                      Показать все
                    </div>
                  </ng-container>
                </ng-container>
                <ng-container *ngIf="code === 'other' && otherPopular && otherPopular.length">
                  <section class="catalog-title-popular-wrap" *ngFor="let item of otherPopular ">
                    <h4 class="title-h6 mt-lg-20 mt-sm-32 mt-md-32 catalog-title-popular catalog-other-popular">
                      {{item.title}}
                    </h4>
                    <div *ngFor="let passport of item.passports | slice:0:(item.otherPopularMore ? undefined : itemsCounter)">
                      <h5 (click)="goToPopular(passport)" class="title-h6 mt-lg-20 mt-sm-32 mt-md-32 pointer">
                        {{passport.catalogTitle}}
                      </h5>
                    </div>
                    <ng-container
                      *ngIf="item.passports && item.passports.length > itemsCounter && !item.otherPopularMore">
                      <div class="mt-32 text-plain blue" (click)="item.otherPopularMore = !item.otherPopularMore">
                        Показать все
                      </div>
                    </ng-container>
                  </section>
                </ng-container>
                <section *ngIf="viewType === 'main-page-view' && regionName && regionPopular?.length">
                  <ng-template [ngTemplateOutlet]="regionPopularTmpl"></ng-template>
                </section>
              </perfect-scrollbar>
            </div>
          </section>
        </div>
        <div  class="col-lg-6 col-3 col-md-6">
          <section *ngIf="viewType !== 'main-page-view' && regionName && regionPopular?.length">
            <h5 class="title-h6 catalog-item-title mt-40 catalog-item-title-small">
              Услуги для <span (click)="showRegionModal()" class="catalog-item-title-link">{{regionName}}</span>
            </h5>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                <ng-template [ngTemplateOutlet]="regionPopularTmpl"></ng-template>
              </perfect-scrollbar>
            </div>
          </section>
          <section *ngIf="viewType === 'main-page-view' && faqs?.length">
            <h3 class="title-h6 catalog-item-title">Часто задаваемые вопросы</h3>
            <div class="scroll-container">
              <perfect-scrollbar [config]="{wheelPropagation: false}">
                <div *ngFor="let item of faqs; let index = index;" class="catalog-title-popular">
                  <h4 *ngIf="item.faqs?.length" [class.mt-lg-24]="index>0" class="title-h6">{{item.title}}</h4>
                  <div class="mt-lg-24" *ngFor="let faq of item.faqs | slice:0:(item.faqsMore ? undefined : itemsCounter)">
                    <div class="flex-container">
                      <div [class.active]="faq.active" (click)="toggleFaqsQuestions(faq)" class="arrow"></div>
                      <div>
                        <h6 (click)="toggleFaqsQuestions(faq)" class="title-h6 title-h6-light pointer">
                          {{faq.shortQuestion || faq.question}}
                        </h6>
                        <div [class.active]="faq.active" class="faq-answer" [innerHTML]="faq.shortAnswer || faq.answer"></div>
                      </div>
                    </div>
                  </div>
                  <ng-container *ngIf="item.faqs && item.faqs.length > itemsCounter && !item.faqsMore">
                    <div class="mt-32 text-plain blue" (click)="item.faqsMore = !item.faqsMore">
                      Показать все
                    </div>
                  </ng-container>
                </div>
              </perfect-scrollbar>
            </div>
          </section>
        </div>
      </div>
      <ng-template #regionPopularTmpl>
        <h5 *ngIf="viewType === 'main-page-view'" class="title-h6 catalog-item-title mt-40 catalog-item-title-small">
          Услуги для <span (click)="showRegionModal()" class="catalog-item-title-link">{{regionName}}</span>
        </h5>
        <h6 (click)="goToPopular(item)"
            *ngFor="let item of regionPopular | slice:0:(regionPopularMore ? undefined : itemsCounter)"
            class="title-h6 mt-lg-20 mt-sm-32 mt-md-32 catalog-title-popular pointer">
          {{item.catalogTitle}}
        </h6>
        <ng-container *ngIf="regionPopular && regionPopular.length > itemsCounter && !regionPopularMore">
          <div class="mt-28 text-plain blue" (click)="regionPopularMore = !regionPopularMore">
            Показать все
          </div>
        </ng-container>
      </ng-template>
    </div>
    <ng-template #loading>
      <div class="catalog-throbber">
        <lib-throbber-hexagon size="big"></lib-throbber-hexagon>
      </div>
    </ng-template>
  </div>
</div>
