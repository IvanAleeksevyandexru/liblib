<div class="range-container" [ngClass]="contextClass ? [contextClass] : []" libClickOutside (clickOutside)="closePanel();">
  <div class="range-field">
    <div class="range-field-from">
      <lib-date-picker #fromDate
        [(ngModel)]="fromText" 
        [name]="name ? name + 'From' : null" 
        [tabIndex]="tabIndex !== undefined ? tabIndex : null"
        [disabled]="disabled"
        [clearable]="clearable"
        [placeholder]="placeholderFrom"
        [asSimpleInput]="showPanel"
        [isRange]="false"
        [textEditable]="textEditable && !blockMobileKeyboard"
        [textModelValue]="textModelValue"
        [brokenDateFixStrategy]="brokenDateFixStrategy"
        [shortYearFormat]="shortYearFormat"
        [americanFormat]="americanFormat"
        [invalid]="invalidFrom"
        [validation]="validationFrom"
        [validationShowOn]="validationShowOn"
        [validationMessages]="validationMessages"
        [minDate]="minDate"
        [maxDate]="showPanel ? maxDate : maxFromDate"
        (click)="toggle(true, $event)" 
        (changed)="handleChange(true, $event)">
      </lib-date-picker>
    </div>
    <div class="range-field-separator">
      &ndash;
    </div>
    <div class="range-field-to">
      <lib-date-picker #toDate
        [(ngModel)]="toText" 
        [name]="name ? name + 'To' : null" 
        [tabIndex]="tabIndex !== undefined ? tabIndex + 1 : null"
        [disabled]="disabled"
        [clearable]="clearable"
        [placeholder]="placeholderFrom"
        [asSimpleInput]="showPanel"
        [isRange]="false"
        [textEditable]="textEditable && !blockMobileKeyboard"
        [textModelValue]="textModelValue"
        [brokenDateFixStrategy]="brokenDateFixStrategy"
        [shortYearFormat]="shortYearFormat"
        [americanFormat]="americanFormat"
        [invalid]="invalidFrom"
        [validation]="validationFrom"
        [validationShowOn]="validationShowOn"
        [validationMessages]="validationMessages"
        [minDate]="showPanel ? minDate : minToDate"
        [maxDate]="maxDate"
        (click)="toggle(false, $event)" 
        (changed)="handleChange(false, $event)">
      </lib-date-picker>
    </div>
  </div>
  <div class="range-dropdown-wrapper">
    <div class="range-dropdown-container" *ngIf="expanded" (click)="returnFocus($event)" >
      <div class="dropdown-header">
        <span class="dropdown-title">{{'RANGE_FIELD.TITLE' | libTranslate}}</span>
      </div>
      <div class="datepickers-block">
        <div class="datepicker-from">
          <lib-date-picker #startDate
            contextClass="range-field-from"
            [asSimplePanel]="true"
            [disabled]="disabled"
            [isRange]="true"
            [textModelValue]="textModelValue"
            [minDate]="minFromDate"
            [maxDate]="maxFromDate"
            [americanFormat]="americanFormat"
            [forcedNavigation]="initialFromMonth"
            [externalDatePropertiesPublisher]="datePropertiesPublisher"
            [(ngModel)]="range"
            (dateSelected)="synchronizeRangeStart(false)"
            (navigated)="navigated(true, $event)"
            (ngModelChange)="rangeUpdated(true)">
          </lib-date-picker>
        </div>
        <div class="separator"></div>
        <div class="datepicker-to">
          <lib-date-picker #endDate
            contextClass="range-field-to"
            [asSimplePanel]="true"
            [disabled]="disabled"
            [isRange]="true"
            [textModelValue]="textModelValue"
            [minDate]="minToDate"
            [maxDate]="maxToDate"
            [americanFormat]="americanFormat"
            [forcedNavigation]="initialToMonth"
            [externalDatePropertiesPublisher]="datePropertiesPublisher"
            [(ngModel)]="range"
            (dateSelected)="synchronizeRangeStart(false)"
            (navigated)="navigated(false, $event)"
            (ngModelChange)="rangeUpdated(true)">
          </lib-date-picker>
        </div>
      </div>
    </div>
  </div>
</div>
